{% extends 'base.html.twig' %}

{% block jumbotron %}
    <div class="jumbotron jumbotron-fluid main-banner">
        <div class="container">
            <div class="py-5"></div>
            <div class="py-5"></div>
        </div>
    </div>

{% endblock %}

{% block main %}

    <h2>Stats</h2>
    <ul>
        <li>Games played: {{ overallStats.noOfGamesPlayed }}</li>
        <li>Cash won: £{{ overallStats.cashWon }}</li>
    </ul>
    <p class="lead">More coming soon...</p>

    {% if leagueTable %}
        {% include "partial/_league_table.html.twig" %}
    {% endif %}

    <hr class="my-4">

    <h2>Games</h2>

    {% if games is empty %}
        <p class="lead">No games played yet</p>
    {% endif %}

    {% for game in games %}

        <h3>{{ game.date|date("D jS, M Y") }}</h3>
        <h4><a href="{{ path('host_show', { 'id': game.host.id }) }}">{{ game.host }}</a> <small class="text-muted">{{ game.host.location }}</small></h4>

        <div class="row">
            <div class="col-sm-6">
                <ul>
                    <li>League: {{ game.isLeague }}</li>
                    <li>Buy in: £{{ game.buyIn }}</li>
                    {% if game.snacksProvider %}
                        <li>Snacks: {{ game.snacks }} by {{ game.snacksProvider }}</li>
                    {% endif %}
                </ul>
            </div>
            <div class="col-sm-6">
                {% if game.spotifyPlaylistUri %}
                    <iframe src="https://open.spotify.com/embed?uri={{ game.spotifyPlaylistUri }}" width="100%" height="80" frameborder="0" allowtransparency="true"></iframe>
                {% endif %}
            </div>

            {% if game.results is empty %}
                <div class="col">
                    <p class="lead">Game not played yet</p>
                </div>
            {% endif %}
        </div>
        {% if game.results is not empty %}

            <div class="row">
                <div class="col">
                    <table class="table text-center table-striped table-responsive-md">
                        <thead class="">
                        <tr>
                            <th>#</th>
                            <th class="text-left">Player</th>
                            <th>Points</th>
                            <th>Winnings</th>
                            <th>Rebuys</th>
                            <th>Net</th>
                            {% if game.league %}
                                <th>League Player</th>
                            {% endif %}
                        </tr>
                        </thead>

                        {# @var result \AppBundle\Entity\Result #}
                        {% for result in game.results %}
                            <tr>
                                <td>{{ result.position }}</td>
                                <td class="text-left"><a href="{{ path('player_show', { 'id': result.player.id }) }}">{{ result.player }}</a></td>
                                <td>{{ result.leaguePoints|number_format(league_points_decimal_places) }}</td>
                                <td>£{{ result.winnings|number_format(0) }}</td>
                                <td>{{ result.noOfRebuys|number_format(0) }}</td>
                                <td>£{{ result.net|number_format(0) }}</td>
                                {% if game.league %}
                                    <td>
                                        {% if result.player.leaguePlayer %}
                                            <span class="oi oi-check"></span>
                                        {% endif %}
                                    </td>
                                {% endif %}
                            </tr>
                        {% endfor %}

                    </table>

                </div>
            </div>

        {% endif %}

        <hr class="my-5">

    {% endfor %}

{% endblock %}


